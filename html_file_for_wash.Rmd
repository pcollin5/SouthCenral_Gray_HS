---
title: "Head Start Measures for Washington County"
author: "Paul Collins"
date: '`r format(Sys.Date(), "%m/%d/%Y")`'
output: 
  prettydoc::html_pretty:
    theme: tactile
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Summary

Census tracts in Washington County Tennessee were examined for their suitability for Head Start classrooms using 5 year estimates from the 2018 American Community Survey (ACS) data from the United States Census Bureau. The tracts were ranked in various metrics pertaining to Head Start and then statistically compared to tracts already containing a Head Start classroom. Based on this information, the top six most in need census tracts are tract 610, tract 613, tract 606, tract 605.02, tract 605.01, and tract 620. As always, the decision to open a classroom in these locations is dependent on a multitude of other factors including funding, physical location restrictions, and many other factors. 
 
# Methods 

The data for Washington County census tracts (and one from Greene County) was pulled from the census website into R and was then cleaned and processed. A total of 25 census tracts were analyzed. Tracts that currently have a Head Start Classroom were designated by their classroom names and locations without current classrooms were given generic names of “Loc1” through “Loc15”. Various data visualizations and tables were constructed to determine where tracks fell in various categories and to see which locations that did not contain a Head Start would be most suitable. Once the top 5 tracts that do not contain a Head Start were selected, these tracks were tested for statistical significance at a 95% confidence level using the estimate and margin of error for the various measures. Tracts were tested against all current Washington County Head Start locations. Based on previous work, the tracts containing the Head Start classrooms Dunbar and Children First were the tracts with the most need in Washington County. Therefore, the candidate tracts performance against these two locations are discussed below. 


```{r load packages and code, echo = FALSE, include = FALSE}

#### load packages ####  

packages <- c("RColorBrewer","acs", "tidyverse", "tidycensus", "tigris", "leaflet", "mapview", "tmap", "DT", "sf", "gganimate", "report", "ipumsr", "xtable", "kableExtra", "knitr", "RgoogleMaps", "stargazer")

lapply(packages, library, character.only = TRUE)

#### get data for the hawkins school system, kepler elementary school, mcpheters bend, fugate hill classrooms ####

#### load the variable names ####

dp_table_variables_18 <- load_variables(2018, "acs5/profile", cache = TRUE)

new_names_18 <- c("variable", "label", "concept")

names(dp_table_variables_18) <- new_names_18   

#### hawkins school system ####

tnss_dp02_2018 <- get_acs(geography = "school district (unified)", state = "TN", table = "DP02", year = 2018, cache = TRUE)

tnss_dp03_2018 <- get_acs(geography = "school district (unified)", state = "TN", table = "DP03", year = 2018, cache = TRUE)

tnss_dp04_2018 <- get_acs(geography = "school district (unified)", state = "TN", table = "DP04", year = 2018, cache = TRUE)

tnss_dp05_2018 <- get_acs(geography = "school district (unified)", state = "TN", table = "DP05", year = 2018, cache = TRUE)

tnss_dp02_18 <- inner_join(tnss_dp02_2018, dp_table_variables_18, by = "variable")

tnss_dp03_18 <- inner_join(tnss_dp03_2018, dp_table_variables_18, by = "variable")

tnss_dp04_18 <- inner_join(tnss_dp04_2018, dp_table_variables_18, by = "variable")

tnss_dp05_18 <- inner_join(tnss_dp05_2018, dp_table_variables_18, by = "variable")

tn_data_profile_18 <- rbind(tnss_dp02_18, tnss_dp03_18, tnss_dp04_18, tnss_dp05_18)

districts <- school_districts(state = "TN", type = "unified", refresh = TRUE)

districts <- st_as_sf(districts)

### need washington and greene county school districts ###

greene_18 <- districts %>%
  filter(NAME == "Greene County School District")

gchs_dp_18 <- tn_data_profile_18 %>%
  filter(NAME == "Greene County School District, Tennessee")

wash_18 <- districts %>%
  filter(NAME == "Washington County School District")

wchs_dp_18 <- tn_data_profile_18 %>%
  filter(NAME == "Washington County School District, Tennessee")

#### pull washington and Greene census tract data ####

#greene

Greene_dp02_2018 <- get_acs(geography = "tract", county = "Greene", state = "TN", table = "DP02", year = 2018, geometry = TRUE, cache = TRUE)

Greene_dp03_2018 <- get_acs(geography = "tract", county = "Greene", state = "TN", table = "DP03", year = 2018, geometry = TRUE, cache = TRUE)

Greene_dp04_2018 <- get_acs(geography = "tract", county = "Greene", state = "TN", table = "DP04", year = 2018, geometry = TRUE, cache = TRUE)

Greene_dp05_2018 <- get_acs(geography = "tract", county = "Greene", state = "TN", table = "DP05", year = 2018, geometry = TRUE, cache = TRUE)    

Greene_dp02_18 <- inner_join(Greene_dp02_2018, dp_table_variables_18, by = "variable")

Greene_dp03_18 <- inner_join(Greene_dp03_2018, dp_table_variables_18, by = "variable")

Greene_dp04_18 <- inner_join(Greene_dp04_2018, dp_table_variables_18, by = "variable")

Greene_dp05_18 <- inner_join(Greene_dp05_2018, dp_table_variables_18, by = "variable")

Greene_data_profile <- rbind(Greene_dp02_18, Greene_dp03_18, Greene_dp04_18, Greene_dp05_18)

#washington

Washington_dp02_2018 <- get_acs(geography = "tract", county = "Washington", state = "TN", table = "DP02", year = 2018, geometry = TRUE, cache = TRUE)

Washington_dp03_2018 <- get_acs(geography = "tract", county = "Washington", state = "TN", table = "DP03", year = 2018, geometry = TRUE, cache = TRUE)

Washington_dp04_2018 <- get_acs(geography = "tract", county = "Washington", state = "TN", table = "DP04", year = 2018, geometry = TRUE, cache = TRUE)

Washington_dp05_2018 <- get_acs(geography = "tract", county = "Washington", state = "TN", table = "DP05", year = 2018, geometry = TRUE, cache = TRUE)    

Washington_dp02_18 <- inner_join(Washington_dp02_2018, dp_table_variables_18, by = "variable")

Washington_dp03_18 <- inner_join(Washington_dp03_2018, dp_table_variables_18, by = "variable")

Washington_dp04_18 <- inner_join(Washington_dp04_2018, dp_table_variables_18, by = "variable")

Washington_dp05_18 <- inner_join(Washington_dp05_2018, dp_table_variables_18, by = "variable")

Washington_data_profile <- rbind(Washington_dp02_18, Washington_dp03_18, Washington_dp04_18, Washington_dp05_18)
```

```{r code, echo = FALSE}
### use geoid's because its easier to filter ###

wash_hs_GEOID <- c(47179061901, 47179061402, 47179060900, 47179061100, 47179060100, 47179061602, 47179061902, 47179060800)

chuckey_hs_GEOID <- c(47059090900)


wash_nohs_GEOID <-c(47179060400,47179060501,47179060502, 47179060600, 47179060700, 47179061000, 47179061200, 47179061300, 47179061401, 47179061500, 47179061601,
47179061701, 47179061702,47179061800, 47179062000)


wash_hs_tracts <- Washington_data_profile %>%
  filter(GEOID %in% wash_hs_GEOID)

chuckey_hs_tract <- Greene_data_profile %>%
  filter(GEOID %in% chuckey_hs_GEOID)

wash_no_hs_tracts <- Washington_data_profile %>%
  filter(GEOID %in% wash_nohs_GEOID)


# add the school names to the location data frame #

south_central <- wash_hs_tracts %>%
  filter(GEOID == 47179061901)

school <- rep("South Central", length(south_central$GEOID))

sc <- cbind(school, south_central)

chuckey <- chuckey_hs_tract

school <- rep("Chuckey", length(chuckey$GEOID))

chu <- cbind(school, chuckey)

west_view <- wash_hs_tracts %>%
  filter(GEOID == 47179061901)

school <- rep("West View", length(west_view$GEOID))

wv <- cbind(school, west_view)

boones <- wash_hs_tracts %>%
  filter(GEOID == 47179061402)

school <- rep("Boones Creek", length(boones$GEOID))

bc <- cbind(school, boones)

child <- wash_hs_tracts %>%
  filter(GEOID == 47179060900)

school <- rep("Children First", length(child$GEOID))

cf <- cbind(school, child)

lake <- wash_hs_tracts %>%
  filter(GEOID == 47179061100)

school <- rep("Lake Terrace", length(lake$GEOID))

lt <- cbind(school, lake)

dunbar <- wash_hs_tracts %>%
  filter(GEOID == 47179060100)

school <- rep("Dunbar", length(dunbar$GEOID))

dun <- cbind(school, dunbar)

harmony <- wash_hs_tracts %>%
  filter(GEOID == 47179061602)

school <- rep("Harmony", length(harmony$GEOID))

harm <- cbind(school, harmony)

grandview <- wash_hs_tracts %>%
  filter(GEOID == 47179061902)

school <-rep("Grandview", length(grandview$GEOID))

gv <- cbind(school, grandview)

southside <- wash_hs_tracts %>%
  filter(GEOID == 47179060800)

school <- rep("South Side", length(southside$GEOID))

ss <- cbind(school, southside)

pretty_tracts <- rbind(sc, chu, wv, bc, cf, lt, dun, harm, gv, ss)




####pull out the variables we need ####

hs_vars <- c("DP02_0045", "DP02_0046", "DP02_0047", "DP02_0053", "DP02_0071", "DP02_0112", "DP02_0151", "DP02_0152", "DP03_0009", "DP03_0062", "DP03_0072", "DP03_0074", "DP03_0119", "DP03_0131",
             "DP05_0001", "DP05_0005", "DP05_0018", "DP05_0064")

hs_per_vars <- c("DP02_0045P", "DP02_0046P", "DP02_0047P", "DP02_0053P", "DP02_0071P", "DP02_0112P", "DP02_0151P", "DP02_0152P", "DP03_0009P", "DP03_0062P", "DP03_0072P", "DP03_0074P", "DP03_0119P", "DP03_0131P",
                 "DP05_0001P", "DP05_0005P","DP05_0018P", "DP05_0064P")

hs_vars_names <- c("Grandparent living in household and responsible for children under 1", "Grandparent living in household and responsible for children 1-2 years old", "Grandparent living in household and responsible for children 3-4 years olds",
                   "Children enrolled in preschool or nursery school", "Citizens with a Disability", "Population ESL", "Households with a Computer", "Households with Broadband internet", "Unemployment Rate", "Median Income",
                   "Total Households with Cash Public Assistance", "Total Households with SNAP", "Percentage of all families below poverty line", "Poverty Rate for children under 5",
                   "Total Population", "Population Age under 5","Median Age", "Population Racially White")

df_tracts <- pretty_tracts %>%
  filter(variable %in% hs_vars)

df_per_tracts <- pretty_tracts %>%
  filter(variable %in% hs_per_vars)

df_combined <- cbind(hs_vars_names, df_tracts, df_per_tracts)

trimmed_df <- df_combined[,c(1,2,4,6,7,14,15)]

###get rid of location for tables 

no_location_trimmed_df <- st_set_geometry(trimmed_df, NULL)

###make new names for table 

hs_table_names <- c("Measure", "Head Start Location", "Census Tract", "Count", "Margin of Error", "Percent", "Percent Margin of Error")

names(no_location_trimmed_df) <- hs_table_names

wash_hs_datatable <- datatable(no_location_trimmed_df, caption = "Various Metrics for Washington County (and Chuckey) Census Tracts Containing a Head Start")



##pdf table##

#xtable(no_location_trimmed_df %>% filter(`Head Start Location`== "South Central"))

###### repeat that for washington county tracts without a head start ####

###make these pretty and see if it helps###

loc1 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179060400)

no_school <- rep("Loc1", length(loc1$GEOID))

l1 <- cbind(no_school, loc1)

loc2 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179060501)

no_school <- rep("Loc2", length(loc2$GEOID))

l2 <- cbind(no_school, loc2)  

loc3 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179060502)

no_school <- rep("Loc3", length(loc3$GEOID))

l3 <- cbind(no_school, loc3)

loc4 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179060600)

no_school <- rep("Loc4", length(loc4$GEOID))

l4 <- cbind(no_school, loc4)

loc5 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179060700)

no_school <- rep("Loc5", length(loc5$GEOID))

l5 <- cbind(no_school, loc5)

loc6 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179061000)

no_school <- rep("Loc6", length(loc6$GEOID))

l6 <- cbind(no_school, loc6)

loc7 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179061200)

no_school <- rep("Loc7", length(loc7$GEOID))

l7 <- cbind(no_school, loc7)

loc8 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179061300)

no_school <- rep("Loc8", length(loc8$GEOID))

l8 <- cbind(no_school, loc8)

loc9 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179061401)

no_school <- rep("Loc9", length(loc9$GEOID))

l9 <- cbind(no_school, loc9)

loc10 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179061500)

no_school <- rep("Loc10", length(loc10$GEOID))

l10 <- cbind(no_school, loc10)

loc11 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179061601)

no_school <- rep("Loc11", length(loc11$GEOID))

l11 <- cbind(no_school, loc11)

loc12 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179061701)

no_school <- rep("Loc12", length(loc12$GEOID))

l12 <- cbind(no_school, loc12)

loc13 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179061702)

no_school <- rep("Loc13", length(loc13$GEOID))

l13 <- cbind(no_school, loc13)

loc14 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179061800)

no_school <- rep("Loc14", length(loc14$GEOID))

l14 <- cbind(no_school, loc14)

loc15 <- wash_no_hs_tracts %>%
  filter(GEOID == 47179062000)

no_school <- rep("Loc15", length(loc15$GEOID))

l15 <- cbind(no_school, loc15)

nohs_pretty_tracts <- rbind(l1,l2,l3,l4,l5,l6,l7,l8,l9,l10,l11,l12,l13,l14,l15)



nohs_df_tracts <- nohs_pretty_tracts %>%
  filter(variable %in% hs_vars)

nohs_df_per_tracts <- nohs_pretty_tracts %>%
  filter(variable %in% hs_per_vars)

nohs_df_combined <- cbind(hs_vars_names, nohs_df_tracts, nohs_df_per_tracts)


trimmed_nohs_df <- nohs_df_combined[,c(1,2,4,6,7,14,15)]

###get rid of location for tables 

no_location_trimmed_nohs_df <- st_set_geometry(trimmed_nohs_df, NULL)

### make data table ###

nohs_table_names <- c("Measure","Head Start Location", "Census Tract", "Count", "Margin of Error", "Percent", "Percent Margin of Error")

names(no_location_trimmed_nohs_df) <- nohs_table_names

wash_nohs_datatable <- datatable(no_location_trimmed_nohs_df, caption = "Various Metrics for Washington County Census Tracts WITHOUT a Head Start")


easy <- no_location_trimmed_df

southcentral <- easy %>%
  filter(`Head Start Location` == "South Central")

boonescreek <- easy %>%
  filter(`Head Start Location` == "Boones Creek")

chuckey <- easy %>%
  filter(`Head Start Location` == "Chuckey")

westview <- easy %>%
  filter(`Head Start Location` == "West View")

childrenfirst <- easy %>%
  filter(`Head Start Location` == "Children First")

laketerrace <- easy %>%
  filter(`Head Start Location` == "Lake Terrace")

dunbar <- easy %>%
  filter(`Head Start Location` == "Dunbar")

Harmony <- easy %>%
  filter(`Head Start Location` == "Harmony")

Grandview <- easy %>%
  filter(`Head Start Location`== "Grandview")

southside <- easy %>%
  filter(`Head Start Location` == "South Side")

vector_names <- as.character(southcentral$Measure)





sc_vs_bc_perc <- significance(southcentral$Percent, boonescreek$Percent, southcentral$`Percent Margin of Error`, boonescreek$`Percent Margin of Error`, 0.95)

sc_vs_bc_counts <- significance(southcentral$Count, boonescreek$Count, southcentral$`Margin of Error`, boonescreek$`Margin of Error`, clevel = 0.95)

sc_vs_chuckey_perc <- significance(southcentral$Percent, chuckey$Percent, southcentral$`Percent Margin of Error`, chuckey$`Percent Margin of Error`, clevel = 0.95)

sc_vs_chuckey_counts <- significance(southcentral$Count, chuckey$Count, southcentral$`Margin of Error`, chuckey$`Margin of Error`, clevel = 0.95)

southcentral_vs_chuckey <- data.frame(vector_names, sc_vs_chuckey_perc, sc_vs_chuckey_counts, southcentral$Percent, chuckey$Percent, southcentral$Count, chuckey$Count)

southcentral_vs_boonescreek <- data.frame(vector_names, sc_vs_bc_perc, sc_vs_bc_counts, southcentral$Percent, boonescreek$Percent, southcentral$Count, boonescreek$Count)

sc_vs_cf_perc <- significance(southcentral$Percent, childrenfirst$Percent, southcentral$`Percent Margin of Error`, childrenfirst$`Percent Margin of Error`, 0.95)

sc_vs_cf_counts <- significance(southcentral$Count, childrenfirst$Count, southcentral$`Margin of Error`, childrenfirst$`Margin of Error`, clevel = 0.95)

southcentral_vs_childrenfirst <- data.frame(vector_names, sc_vs_cf_perc, sc_vs_cf_counts, southcentral$Percent, childrenfirst$Percent, southcentral$Count, childrenfirst$Count)

sc_vs_lt_perc <- significance(southcentral$Percent, laketerrace$Percent, southcentral$`Percent Margin of Error`, laketerrace$`Percent Margin of Error`, 0.95)

sc_vs_lt_counts <- significance(southcentral$Count, laketerrace$Count, southcentral$`Margin of Error`, laketerrace$`Margin of Error`, clevel = 0.95)

southcentral_vs_laketerrace <- data.frame(vector_names, sc_vs_lt_perc, sc_vs_lt_counts, southcentral$Percent, laketerrace$Percent, southcentral$Count, laketerrace$Count)

#dunbar

sc_vs_db_perc <- significance(southcentral$Percent, dunbar$Percent, southcentral$`Percent Margin of Error`, dunbar$`Percent Margin of Error`, 0.95)

sc_vs_db_counts <- significance(southcentral$Count, dunbar$Count, southcentral$`Margin of Error`, dunbar$`Margin of Error`, clevel = 0.95)

southcentral_vs_dunbar <- data.frame(vector_names, sc_vs_db_perc, sc_vs_db_counts, southcentral$Percent, dunbar$Percent, southcentral$Count, dunbar$Count)

#harmony

sc_vs_hm_perc <- significance(southcentral$Percent, Harmony$Percent, southcentral$`Percent Margin of Error`, Harmony$`Percent Margin of Error`, 0.95)

sc_vs_hm_counts <- significance(southcentral$Count, Harmony$Count, southcentral$`Margin of Error`, Harmony$`Margin of Error`, clevel = 0.95)

southcentral_vs_harmony <- data.frame(vector_names, sc_vs_hm_perc, sc_vs_hm_counts, southcentral$Percent, Harmony$Percent, southcentral$Count, Harmony$Count)


#grandview

sc_vs_gv_perc <- significance(southcentral$Percent, Grandview$Percent, southcentral$`Percent Margin of Error`, Grandview$`Percent Margin of Error`, 0.95)

sc_vs_gv_counts <- significance(southcentral$Count, Grandview$Count, southcentral$`Margin of Error`, Grandview$`Margin of Error`, clevel = 0.95)

southcentral_vs_grandview <- data.frame(vector_names, sc_vs_gv_perc, sc_vs_gv_counts, southcentral$Percent, Grandview$Percent, southcentral$Count, Grandview$Count)

#southside

sc_vs_ss_perc <- significance(southcentral$Percent, southside$Percent, southcentral$`Percent Margin of Error`, southside$`Percent Margin of Error`, 0.95)

sc_vs_ss_counts <- significance(southcentral$Count, southside$Count, southcentral$`Margin of Error`, southside$`Margin of Error`, clevel = 0.95)

southcentral_vs_southside <- data.frame(vector_names, sc_vs_ss_perc, sc_vs_ss_counts, southcentral$Percent, southside$Percent, southcentral$Count, southside$Count)

#data tables of significance

#datatable(southcentral_vs_boonescreek)
#datatable(southcentral_vs_chuckey)
#datatable(southcentral_vs_childrenfirst)
#datatable(southcentral_vs_laketerrace)
#datatable(southcentral_vs_dunbar)
#datatable(southcentral_vs_harmony)
#datatable(southcentral_vs_grandview)
#datatable(southcentral_vs_southside)

## other tables for report 

under_5 <- no_location_trimmed_df %>%
  filter(Measure == "Population Age under 5")

under_5_bar <-under_5 %>%
  ggplot(aes(y = Percent, x = `Head Start Location`, fill = `Head Start Location`)) + 
  geom_bar(position = "stack", stat = "identity") +
  scale_color_brewer(palette = "Dark2")+ 
  ggtitle("Percent of Population under 5 Years Old")

median_income <- no_location_trimmed_df %>%
  filter(Measure == "Median Income")

median_income_bar <- median_income %>%
  ggplot(aes(y = Count, x = `Head Start Location`, fill = `Head Start Location`)) + 
  geom_bar(position = "stack", stat = "identity") +
  scale_color_brewer(palette = "Dark2")+ 
  ggtitle("Median Income") +
  ylab("Median Income in Dollars")

white <- no_location_trimmed_df %>%
  filter(Measure == "Population Racially White")

white_bar <- white%>%
  ggplot(aes(y = Percent, x = `Head Start Location`, fill = `Head Start Location`)) + 
  geom_bar(position = "stack", stat = "identity") +
  scale_color_brewer(palette = "Dark2")+ 
  ggtitle("Percent of Population Racially White")

unep <- no_location_trimmed_df %>%
  filter(Measure == "Unemployment Rate")

unep_bar <- unep%>%
  ggplot(aes(y = Percent, x = `Head Start Location`, fill = `Head Start Location`)) + 
  geom_bar(position = "stack", stat = "identity") +
  scale_color_brewer(palette = "Dark2")+ 
  ggtitle("Aggregate Unemployment Rate from 2013-2018")


#### stuff for no classrooms ####


map_names <- c("Measure", "Location", "Tract", "Est", "Margin of Error", "Percent", "Percent Margin of Error", "geometry")

nohs_map_df <- trimmed_nohs_df 

hs_map_df <- trimmed_df

names(nohs_map_df) <- map_names

names(hs_map_df) <- map_names

nohs_med_income <- nohs_map_df %>%
  filter(Measure == "Median Income")

hs_med_income <- hs_map_df %>%
  filter(Measure == "Median Income")

#combine both hs and no hs together

noloc_complete_df <- rbind(no_location_trimmed_nohs_df, no_location_trimmed_df)

loc_complete_df <- rbind(nohs_map_df, hs_map_df)

```


```{r data table for all of washington count, echo = FALSE}

#### data table stuff ####

wash_dt <- datatable(noloc_complete_df, caption = "Various Measures for Washington County")

wash_dt
####map stuff ####

tract_map <- mapview(loc_complete_df, zcol = "Tract", legend = FALSE)

tract_map
```


# Results 

Data tables and visualizations for the data follow. A searchable data table is first, showing the metrics used in this analysis by location. A reference map is next, showing the location for census tracts within the county. The candidate tracts were selected based on their rankings of childhood poverty rate, overall poverty rate, percent of population under 5 years of age, and percent of population that speak English as a second language (ESL). Tracts 610, 613, 606, 605.02, 605.01, and 620 were the most promising tracts based on these factors, and they will be discussed individually on their profiles and statistical significance when compared with the current Dunbar and Children First locations.

```{r median income map, echo = FALSE, message = FALSE}
#median income

med_income <-loc_complete_df %>%
  filter(Measure == "Median Income")


all_median_income_bar <- med_income %>%
  ggplot(aes(y = Est, x = reorder(`Location`, -Est), fill = `Location`)) + 
  geom_bar(position = "stack", stat = "identity") +
  scale_color_brewer(palette = "Dark2")+ 
  ggtitle("Median Income") +
  ylab("Median Income in Dollars") + 
  xlab("Location")

all_median_income_bar

median_income_map <- mapview(med_income, zcol = "Est", legend = TRUE, layer.name = "Median Income in Dollars")

median_income_map

#pop under 5

pop_under_5 <- loc_complete_df %>%
  filter(Measure == "Population Age under 5")

all_pop_under_5_bar <- pop_under_5 %>%
  ggplot(aes(y = Percent, x = reorder(`Location`, -Percent), fill = `Location`)) + 
  geom_bar(position = "stack", stat = "identity") +
  scale_color_brewer(palette = "Dark2")+ 
  ggtitle("Percent of Population Under 5") +
  ylab("Percent Under 5") + 
  xlab("Location")

all_pop_under_5_bar

pop_under_5_map <- mapview(pop_under_5, zcol = "Percent", legdend = TRUE, layer.name = "Percent Pop. Under 5")

pop_under_5_map

#childhood poverty

child_pov <- loc_complete_df %>%
  filter(Measure == "Poverty Rate for children under 5")

all_child_pov_bar <-  child_pov %>%
  ggplot(aes(y = Percent, x = reorder(`Location`, -Percent), fill = `Location`)) + 
  geom_bar(position = "stack", stat = "identity") +
  scale_color_brewer(palette = "Dark2")+ 
  ggtitle("Childhood Poverty") +
  ylab("Percent Under 5 Below Poverty Line") + 
  xlab("Location")

all_child_pov_bar

pov_under_5_map <- mapview(child_pov, zcol = "Percent", legdend = TRUE, layer.name = "Under 5 Poverty")

pov_under_5_map

#percent white

 white <- loc_complete_df %>%
   filter(Measure == "Population Racially White")

 all_white_bar <- white %>%
   ggplot(aes(y = Percent, x = reorder(`Location`, -Percent), fill = `Location`)) + 
   geom_bar(position = "stack", stat = "identity") +
   scale_color_brewer(palette = "Dark2")+ 
   ggtitle("Percent Racially White") +
   ylab("Percent Racially White") + 
   xlab("Location")

 all_white_bar
 
 white_map <- mapview(white, zcol = "Percent", legdend = TRUE, layer.name = "Percent Racially White")
  
 white_map 

#esl
 
 esl <- loc_complete_df %>%
   filter(Measure == "Population ESL")

 all_esl_bar <- esl %>%
   ggplot(aes(y = Percent, x = reorder(`Location`, -Percent), fill = `Location`)) + 
   geom_bar(position = "stack", stat = "identity") +
   scale_color_brewer(palette = "Dark2")+ 
   ggtitle("Percent ESL") +
   ylab("Percent ESL") + 
   xlab("Location")

 all_esl_bar
   
 esl_map <- mapview(esl, zcol = "Percent", layer.name = "Percent ESL")
 
 esl_map
 
#median age 

med_age <- loc_complete_df %>%
  filter(Measure == "Median Age")

all_med_age_bar <- med_age %>%
  ggplot(aes(y = Est, x = reorder(`Location`, -Est), fill = `Location`)) + 
  geom_bar(position = "stack", stat = "identity") +
  scale_color_brewer(palette = "Dark2")+ 
  ggtitle("Median Age") +
  ylab("Median Age in Years") + 
  xlab("Location")

all_med_age_bar

med_age_map <- mapview(med_age, zcol = "Est", layer.name = "Median Age")

med_age_map

```

```{r data for individual candidate tracts, echo = FALSE}

Loc6 <- noloc_complete_df %>%
  filter(`Head Start Location` == "Loc6")

Loc8 <- noloc_complete_df %>%
  filter(`Head Start Location` == "Loc8")

Loc4 <- noloc_complete_df %>%
  filter(`Head Start Location` == "Loc4")

Loc3 <- noloc_complete_df %>%
  filter(`Head Start Location` == "Loc3")

Loc2 <- noloc_complete_df %>%
  filter(`Head Start Location` == "Loc2")

Loc15 <- noloc_complete_df %>%
  filter(`Head Start Location` == "Loc15")

candidate_df <- rbind(Loc6, Loc8, Loc4, Loc3, Loc2, Loc15)


```

# Map of Candidate Tracts

```{r map of candidate tracts, echo = FALSE}

mLoc6 <- loc_complete_df %>%
  filter(Location == "Loc6")

mLoc8 <- loc_complete_df %>%
  filter(Location == "Loc8")

mLoc4 <- loc_complete_df %>%
  filter(Location == "Loc4")

mLoc3 <- loc_complete_df %>%
  filter(Location == "Loc3")

mLoc2 <- loc_complete_df %>%
  filter(Location == "Loc2")

mLoc15 <- loc_complete_df %>%
  filter(Location == "Loc15")

loc_map_df <- rbind(mLoc6, mLoc8, mLoc4, mLoc3, mLoc2, mLoc15)

cand_map <-mapview(loc_map_df, zcol = "Location", layer.name = "Candidate Tracts", legend = FALSE)

cand_map


```

# Data Table of Candidate Tracts

```{r data table, echo = FALSE}

candidate_df <- rbind(Loc6, Loc8, Loc4, Loc3, Loc2, Loc15)

candidate_datatable <- datatable(candidate_df, caption = "Six Candidate Tracts")

candidate_datatable

```

# Tract 610 

Census tract 610 is located along East Unaka and East Watauga Ave in Johnson City. The median income was $30,637 (21 of 25). The poverty rate for children under 5 was 92.1% (25 of 25), and 29.9% of all households are below the poverty line (23 of 25). The 5 year aggregate unemployment rate was 7% (18 of 25). 4.1% of the population was below 5 years of age (20 of 25), and 2.8% of the population are ESL (15 of 25). 30.2% of households receive SNAP benefits (4 of 25). 86.8% of the population is racially white, the 5th lowest in Washington County (5 of 25), and the median age was 37.6 (7 of 25). 

When compared with the tract containing Children First, the only statistically significant difference was  Children First had 14.6% of its population under the age of 5, while tract 610 had 4.1%. When compared with the tract containing Dunbar, there were two statistically significant differences. Dunbar had a higher ESL population percentage (8.7% vs. 2.8%) and tract 610 had a higher poverty rate for children under 5 (92.1% vs 44.8%). These tests suggest a strong need for a Head Start Location in this area.


```{r tract 610, echo = FALSE}

l6data_table <- datatable(Loc6, caption = "Census Tract 610")

l6data_table


```

# Tract 613 

Census tract 613 is located in the area along Bristol Highway up to Interstate 26 in Johnson City. The median income was $54,567 (8 of 25) and the poverty rate for children under 5 was 40.9% (21 of 25). 9.3% (11 of 25) of all households were below the poverty line. The 5 year aggregate unemployment rate was 4.9% (14 of 25). 4.8% of the population was below 5 years of age (13 of 25), and 10.6% of the population are ESL (1 of 25), the highest in Washington County. 5.2% of households receive SNAP benefits (24 of 25).  90.3% of the population is racially white (11 of 25), and the median age is 41.1 (11 of 25).

When compared with the tract containing Children First, tract 613 had significantly lower percentage of families receiving SNAP benefits, significantly lower percentage of population under 5, significantly lower percentage of all families below the poverty line, a significantly higher ESL population, and a significantly higher median income. When compared with Dunbar, tract 613 had a significantly lower 5 year aggregate unemployment rate, significantly higher median income, significantly lower percentage of families below the poverty line, and a significantly higher median age. 


```{r tract 613, echo = FALSE}

l8data_table <- datatable(Loc8, caption = "Census Tract 613")

l8data_table

```

# Tract 606 

Census tract 606 is located south of ETSU and boarders Carter County. The median income was $38,704 (17 of 25). The poverty rate for children under 5 was 40.1% (20 of 25). 18.2% (19 of 25) of all households were below the poverty line. The 5 year aggregate unemployment rate was 8.6% (21 of 25). 3.6% of the population was below 5 years of age (22 of 25), and 9.9% of the population are ESL (2 of 25). 10.4% of the population receive SNAP benefits (16 of 25), 87.1% of the population is racially white (6 of 25), and the median age is 27.4 (2 of 25), the lowest in Washington County outside of the track containing ETSU. 

When compared with Children First, census tract 606 had a significantly lower percentage of total households receiving SNAP benefits, percentage of the population below age 5, significantly lower percentage of all families below the poverty line, and significantly higher median income. When compared with Dunbar, census tract 606 had significantly lower percentage of families with SNAP benefits, percentage of families below the poverty line, and a significantly higher median income. 



```{r tract 606, echo = FALSE}

l4data_table <- datatable(Loc4, caption = "Census Tract 606")

l4data_table

```

# Tract 605.02

Census tract 605.02 is located between Johnson City and Jonesboro. The median income was $41,413 (13 of 25). The poverty rate for children under 5 was 39.3% (19 of 25). 13.8% (17 of 25) of all households were below the poverty line. The 5 year aggregate unemployment rate was 3.7% (10 of 25). 4.7% of the population was below 5 years of age (24 of 25), and 8.9% of the population are ESL (5 of 25). 11.9% of the population receive SNAP benefits (13 of 25), 88.4% of the population is racially white (8 of 25), and median age of 38.1 (8 of 25). 

When compared with Children First, tract 605.02 had a significantly higher percentage of ESL, a significantly lower 5 year aggregate unemployment rate, significantly lower percentage of families receiving SNAP benefits, significantly lower percentage of families below the poverty line, significantly lower percentage of the population below age 5, and a significantly higher median income. When compared with Dunbar, tract 605.02 had a significantly lower 5 year aggregate unemployment rate, significantly lower percentage of families receiving SNAP benefits, significantly lower percentage of all families below the poverty line, and significantly higher median income. 

```{r tract 605.02, echo = FALSE}

l3data_table <- datatable(Loc3, caption = "Census Tract 605.02")

l3data_table

```

# Tract 605.01

Census tract 605.01 is located in the West Market Street area on the Western side of State of Franklin Road. The median income was $28,349 (23 of 25), the lowest in Washington County without a Head Start Location. The poverty rate for children under 5 was 35% (18 of 25). 19.8% (20 of 25) of all households were below the poverty line. The 5 year aggregate unemployment rate was 6% (16 of 25). 4.5% of the population was below 5 years of age (15 of 25), and 4.2% of the population are ESL (12 of 25). 23% of the population receive SNAP benefits (5 of 25), 90.5% of the population is racially white (12 of 25), and the median age is 44.9 (19 of 25). 

When compared with Children First, tract 605.01 had significantly lower percentage of families receiving SNAP benefits, lower percentage of all families below the poverty line, lower percentage of population under age 5, and significantly higher median age. When compared with Dunbar, tract 605.01 had significantly lower 5-year aggregate unemployment rate, significantly higher median age, and significantly higher median income.


```{r tract 605.01, echo = FALSE}

l2data_table <- datatable(Loc2, caption = "Census Tract 605.01")

l2data_table


```

# Tract 620

Census tract 620 is located near the Clark Manor neighborhood. The median income was $33,947 (20 of 25). The poverty rate for children under 5 was only 3.5% (8 of 25) but not significantly different than the rate for the tract containing the Harmony classroom (8%). 9.4% (12 of 25) of all households were below the poverty line. The 5-year aggregate unemployment rate was 5.7% (15 of 25). 6.6% of the population was below 5 years of age (4 of 25), and 9.1% of the population are ESL (3 of 25). 16.7% of the population receive SNAP benefits (9 of 25), 81.3% of the population is racially white (2 of 25) and the median age is 42.3 (15 of 25). 

When compared with Children First, census tract 620 had a significantly higher ESL population, significantly lower percentage of households receiving SNAP benefits, significantly lower percentage of total families below the poverty line, significantly lower total population under age 5, significantly higher median age and median income. When compared with Dunbar, tract 620 had a significantly higher median income, significantly lower unemployment rate, significantly lower total households receiving SNAP benefits, significantly lower poverty rate for children under 5 and all families, and significantly lower population that is racially white. 

```{r tract 620, echo = FALSE}

l15data_table <- datatable(Loc15, caption = "Census Tract 620")

l15data_table

```

# Conclusion

In conclusion, six potential census tracts for a future Head Start location in Washington County were identified using the 2018 ACS data. These tracts were ranked in various categories and statistically tested against census tracts that currently contain a Head Start in Washington County. The data suggests tract 620 is in the most need of a Head Start location, but all six tracts presented have needs. As always, the select of Head Start classrooms are determined by many other factors besides data, and these factors should be considered before any final selection is made. 

```{r statistical tests, echo = FALSE}

#### statistically analysis of these locations vs current head start locations ####


loc6_vs_bc_perc <- significance(Loc6$Percent, boonescreek$Percent, Loc6$`Percent Margin of Error`, boonescreek$`Percent Margin of Error`, 0.95)

loc6_vs_bc_counts <- significance(Loc6$Count, boonescreek$Count, Loc6$`Margin of Error`, boonescreek$`Margin of Error`, clevel = 0.95)

loc6_vs_chuckey_perc <- significance(Loc6$Percent, chuckey$Percent, Loc6$`Percent Margin of Error`, chuckey$`Percent Margin of Error`, clevel = 0.95)

loc6_vs_chuckey_counts <- significance(Loc6$Count, chuckey$Count, Loc6$`Margin of Error`, chuckey$`Margin of Error`, clevel = 0.95)

Loc6_vs_chuckey <- data.frame(vector_names, loc6_vs_chuckey_perc, loc6_vs_chuckey_counts, Loc6$Percent, chuckey$Percent, Loc6$Count, chuckey$Count)

Loc6_vs_boonescreek <- data.frame(vector_names, loc6_vs_bc_perc, loc6_vs_bc_counts, Loc6$Percent, boonescreek$Percent, Loc6$Count, boonescreek$Count)

loc6_vs_cf_perc <- significance(Loc6$Percent, childrenfirst$Percent, Loc6$`Percent Margin of Error`, childrenfirst$`Percent Margin of Error`, 0.95)

loc6_vs_cf_counts <- significance(Loc6$Count, childrenfirst$Count, Loc6$`Margin of Error`, childrenfirst$`Margin of Error`, clevel = 0.95)

Loc6_vs_childrenfirst <- data.frame(vector_names, loc6_vs_cf_perc, loc6_vs_cf_counts, Loc6$Percent, childrenfirst$Percent, Loc6$Count, childrenfirst$Count)

loc6_vs_lt_perc <- significance(Loc6$Percent, laketerrace$Percent, Loc6$`Percent Margin of Error`, laketerrace$`Percent Margin of Error`, 0.95)

loc6_vs_lt_counts <- significance(Loc6$Count, laketerrace$Count, Loc6$`Margin of Error`, laketerrace$`Margin of Error`, clevel = 0.95)

Loc6_vs_laketerrace <- data.frame(vector_names, loc6_vs_lt_perc, loc6_vs_lt_counts, Loc6$Percent, laketerrace$Percent, Loc6$Count, laketerrace$Count)

#dunbar

loc6_vs_db_perc <- significance(Loc6$Percent, dunbar$Percent, Loc6$`Percent Margin of Error`, dunbar$`Percent Margin of Error`, 0.95)

loc6_vs_db_counts <- significance(Loc6$Count, dunbar$Count, Loc6$`Margin of Error`, dunbar$`Margin of Error`, clevel = 0.95)

Loc6_vs_dunbar <- data.frame(vector_names, loc6_vs_db_perc, loc6_vs_db_counts, Loc6$Percent, dunbar$Percent, Loc6$Count, dunbar$Count)

#harmony

loc6_vs_hm_perc <- significance(Loc6$Percent, Harmony$Percent, Loc6$`Percent Margin of Error`, Harmony$`Percent Margin of Error`, 0.95)

loc6_vs_hm_counts <- significance(Loc6$Count, Harmony$Count, Loc6$`Margin of Error`, Harmony$`Margin of Error`, clevel = 0.95)

Loc6_vs_harmony <- data.frame(vector_names, loc6_vs_hm_perc, loc6_vs_hm_counts, Loc6$Percent, Harmony$Percent, Loc6$Count, Harmony$Count)


#grandview

loc6_vs_gv_perc <- significance(Loc6$Percent, Grandview$Percent, Loc6$`Percent Margin of Error`, Grandview$`Percent Margin of Error`, 0.95)

loc6_vs_gv_counts <- significance(Loc6$Count, Grandview$Count, Loc6$`Margin of Error`, Grandview$`Margin of Error`, clevel = 0.95)

Loc6_vs_grandview <- data.frame(vector_names, loc6_vs_gv_perc, loc6_vs_gv_counts, Loc6$Percent, Grandview$Percent, Loc6$Count, Grandview$Count)

#southside

loc6_vs_ss_perc <- significance(Loc6$Percent, southside$Percent, Loc6$`Percent Margin of Error`, southside$`Percent Margin of Error`, 0.95)

loc6_vs_ss_counts <- significance(Loc6$Count, southside$Count, Loc6$`Margin of Error`, southside$`Margin of Error`, clevel = 0.95)

Loc6_vs_southside <- data.frame(vector_names, loc6_vs_ss_perc, loc6_vs_ss_counts, Loc6$Percent, southside$Percent, Loc6$Count, southside$Count)

l6bc <- datatable(Loc6_vs_boonescreek)
l6ch <- datatable(Loc6_vs_chuckey)
l6cf <- datatable(Loc6_vs_childrenfirst)
l6lt <- datatable(Loc6_vs_laketerrace)
l6db <- datatable(Loc6_vs_dunbar)
l6hm <- datatable(Loc6_vs_harmony)
l6gv <- datatable(Loc6_vs_grandview)
l6ss <- datatable(Loc6_vs_southside)



#loc8


Loc8_vs_bc_perc <- significance(Loc8$Percent, boonescreek$Percent, Loc8$`Percent Margin of Error`, boonescreek$`Percent Margin of Error`, 0.95)

Loc8_vs_bc_counts <- significance(Loc8$Count, boonescreek$Count, Loc8$`Margin of Error`, boonescreek$`Margin of Error`, clevel = 0.95)

Loc8_vs_chuckey_perc <- significance(Loc8$Percent, chuckey$Percent, Loc8$`Percent Margin of Error`, chuckey$`Percent Margin of Error`, clevel = 0.95)

Loc8_vs_chuckey_counts <- significance(Loc8$Count, chuckey$Count, Loc8$`Margin of Error`, chuckey$`Margin of Error`, clevel = 0.95)

Loc8_vs_chuckey <- data.frame(vector_names, Loc8_vs_chuckey_perc, Loc8_vs_chuckey_counts, Loc8$Percent, chuckey$Percent, Loc8$Count, chuckey$Count)

Loc8_vs_boonescreek <- data.frame(vector_names, Loc8_vs_bc_perc, Loc8_vs_bc_counts, Loc8$Percent, boonescreek$Percent, Loc8$Count, boonescreek$Count)

Loc8_vs_cf_perc <- significance(Loc8$Percent, childrenfirst$Percent, Loc8$`Percent Margin of Error`, childrenfirst$`Percent Margin of Error`, 0.95)

Loc8_vs_cf_counts <- significance(Loc8$Count, childrenfirst$Count, Loc8$`Margin of Error`, childrenfirst$`Margin of Error`, clevel = 0.95)

Loc8_vs_childrenfirst <- data.frame(vector_names, Loc8_vs_cf_perc, Loc8_vs_cf_counts, Loc8$Percent, childrenfirst$Percent, Loc8$Count, childrenfirst$Count)

Loc8_vs_lt_perc <- significance(Loc8$Percent, laketerrace$Percent, Loc8$`Percent Margin of Error`, laketerrace$`Percent Margin of Error`, 0.95)

Loc8_vs_lt_counts <- significance(Loc8$Count, laketerrace$Count, Loc8$`Margin of Error`, laketerrace$`Margin of Error`, clevel = 0.95)

Loc8_vs_laketerrace <- data.frame(vector_names, Loc8_vs_lt_perc, Loc8_vs_lt_counts, Loc8$Percent, laketerrace$Percent, Loc8$Count, laketerrace$Count)

#dunbar

Loc8_vs_db_perc <- significance(Loc8$Percent, dunbar$Percent, Loc8$`Percent Margin of Error`, dunbar$`Percent Margin of Error`, 0.95)

Loc8_vs_db_counts <- significance(Loc8$Count, dunbar$Count, Loc8$`Margin of Error`, dunbar$`Margin of Error`, clevel = 0.95)

Loc8_vs_dunbar <- data.frame(vector_names, Loc8_vs_db_perc, Loc8_vs_db_counts, Loc8$Percent, dunbar$Percent, Loc8$Count, dunbar$Count)

#harmony

Loc8_vs_hm_perc <- significance(Loc8$Percent, Harmony$Percent, Loc8$`Percent Margin of Error`, Harmony$`Percent Margin of Error`, 0.95)

Loc8_vs_hm_counts <- significance(Loc8$Count, Harmony$Count, Loc8$`Margin of Error`, Harmony$`Margin of Error`, clevel = 0.95)

Loc8_vs_harmony <- data.frame(vector_names, Loc8_vs_hm_perc, Loc8_vs_hm_counts, Loc8$Percent, Harmony$Percent, Loc8$Count, Harmony$Count)


#grandview

Loc8_vs_gv_perc <- significance(Loc8$Percent, Grandview$Percent, Loc8$`Percent Margin of Error`, Grandview$`Percent Margin of Error`, 0.95)

Loc8_vs_gv_counts <- significance(Loc8$Count, Grandview$Count, Loc8$`Margin of Error`, Grandview$`Margin of Error`, clevel = 0.95)

Loc8_vs_grandview <- data.frame(vector_names, Loc8_vs_gv_perc, Loc8_vs_gv_counts, Loc8$Percent, Grandview$Percent, Loc8$Count, Grandview$Count)

#southside

Loc8_vs_ss_perc <- significance(Loc8$Percent, southside$Percent, Loc8$`Percent Margin of Error`, southside$`Percent Margin of Error`, 0.95)

Loc8_vs_ss_counts <- significance(Loc8$Count, southside$Count, Loc8$`Margin of Error`, southside$`Margin of Error`, clevel = 0.95)

Loc8_vs_southside <- data.frame(vector_names, Loc8_vs_ss_perc, Loc8_vs_ss_counts, Loc8$Percent, southside$Percent, Loc8$Count, southside$Count)

l8bc <- datatable(Loc8_vs_boonescreek)
l8ch <- datatable(Loc8_vs_chuckey)
l8cf <- datatable(Loc8_vs_childrenfirst)
l8lt <- datatable(Loc8_vs_laketerrace)
l8db <- datatable(Loc8_vs_dunbar)
l8hm <- datatable(Loc8_vs_harmony)
l8gv <- datatable(Loc8_vs_grandview)
l8ss <- datatable(Loc8_vs_southside)

#loc4


Loc4_vs_bc_perc <- significance(Loc4$Percent, boonescreek$Percent, Loc4$`Percent Margin of Error`, boonescreek$`Percent Margin of Error`, 0.95)

Loc4_vs_bc_counts <- significance(Loc4$Count, boonescreek$Count, Loc4$`Margin of Error`, boonescreek$`Margin of Error`, clevel = 0.95)

Loc4_vs_chuckey_perc <- significance(Loc4$Percent, chuckey$Percent, Loc4$`Percent Margin of Error`, chuckey$`Percent Margin of Error`, clevel = 0.95)

Loc4_vs_chuckey_counts <- significance(Loc4$Count, chuckey$Count, Loc4$`Margin of Error`, chuckey$`Margin of Error`, clevel = 0.95)

Loc4_vs_chuckey <- data.frame(vector_names, Loc4_vs_chuckey_perc, Loc4_vs_chuckey_counts, Loc4$Percent, chuckey$Percent, Loc4$Count, chuckey$Count)

Loc4_vs_boonescreek <- data.frame(vector_names, Loc4_vs_bc_perc, Loc4_vs_bc_counts, Loc4$Percent, boonescreek$Percent, Loc4$Count, boonescreek$Count)

Loc4_vs_cf_perc <- significance(Loc4$Percent, childrenfirst$Percent, Loc4$`Percent Margin of Error`, childrenfirst$`Percent Margin of Error`, 0.95)

Loc4_vs_cf_counts <- significance(Loc4$Count, childrenfirst$Count, Loc4$`Margin of Error`, childrenfirst$`Margin of Error`, clevel = 0.95)

Loc4_vs_childrenfirst <- data.frame(vector_names, Loc4_vs_cf_perc, Loc4_vs_cf_counts, Loc4$Percent, childrenfirst$Percent, Loc4$Count, childrenfirst$Count)

Loc4_vs_lt_perc <- significance(Loc4$Percent, laketerrace$Percent, Loc4$`Percent Margin of Error`, laketerrace$`Percent Margin of Error`, 0.95)

Loc4_vs_lt_counts <- significance(Loc4$Count, laketerrace$Count, Loc4$`Margin of Error`, laketerrace$`Margin of Error`, clevel = 0.95)

Loc4_vs_laketerrace <- data.frame(vector_names, Loc4_vs_lt_perc, Loc4_vs_lt_counts, Loc4$Percent, laketerrace$Percent, Loc4$Count, laketerrace$Count)

#dunbar

Loc4_vs_db_perc <- significance(Loc4$Percent, dunbar$Percent, Loc4$`Percent Margin of Error`, dunbar$`Percent Margin of Error`, 0.95)

Loc4_vs_db_counts <- significance(Loc4$Count, dunbar$Count, Loc4$`Margin of Error`, dunbar$`Margin of Error`, clevel = 0.95)

Loc4_vs_dunbar <- data.frame(vector_names, Loc4_vs_db_perc, Loc4_vs_db_counts, Loc4$Percent, dunbar$Percent, Loc4$Count, dunbar$Count)

#harmony

Loc4_vs_hm_perc <- significance(Loc4$Percent, Harmony$Percent, Loc4$`Percent Margin of Error`, Harmony$`Percent Margin of Error`, 0.95)

Loc4_vs_hm_counts <- significance(Loc4$Count, Harmony$Count, Loc4$`Margin of Error`, Harmony$`Margin of Error`, clevel = 0.95)

Loc4_vs_harmony <- data.frame(vector_names, Loc4_vs_hm_perc, Loc4_vs_hm_counts, Loc4$Percent, Harmony$Percent, Loc4$Count, Harmony$Count)


#grandview

Loc4_vs_gv_perc <- significance(Loc4$Percent, Grandview$Percent, Loc4$`Percent Margin of Error`, Grandview$`Percent Margin of Error`, 0.95)

Loc4_vs_gv_counts <- significance(Loc4$Count, Grandview$Count, Loc4$`Margin of Error`, Grandview$`Margin of Error`, clevel = 0.95)

Loc4_vs_grandview <- data.frame(vector_names, Loc4_vs_gv_perc, Loc4_vs_gv_counts, Loc4$Percent, Grandview$Percent, Loc4$Count, Grandview$Count)

#southside

Loc4_vs_ss_perc <- significance(Loc4$Percent, southside$Percent, Loc4$`Percent Margin of Error`, southside$`Percent Margin of Error`, 0.95)

Loc4_vs_ss_counts <- significance(Loc4$Count, southside$Count, Loc4$`Margin of Error`, southside$`Margin of Error`, clevel = 0.95)

Loc4_vs_southside <- data.frame(vector_names, Loc4_vs_ss_perc, Loc4_vs_ss_counts, Loc4$Percent, southside$Percent, Loc4$Count, southside$Count)

l4bc <- datatable(Loc4_vs_boonescreek)
l4ch <- datatable(Loc4_vs_chuckey)
l4cf <- datatable(Loc4_vs_childrenfirst)
l4lt <- datatable(Loc4_vs_laketerrace)
l4db <- datatable(Loc4_vs_dunbar)
l4hm <- datatable(Loc4_vs_harmony)
l4gv <- datatable(Loc4_vs_grandview)
l4ss <- datatable(Loc4_vs_southside)

#loc3


Loc3_vs_bc_perc <- significance(Loc3$Percent, boonescreek$Percent, Loc3$`Percent Margin of Error`, boonescreek$`Percent Margin of Error`, 0.95)

Loc3_vs_bc_counts <- significance(Loc3$Count, boonescreek$Count, Loc3$`Margin of Error`, boonescreek$`Margin of Error`, clevel = 0.95)

Loc3_vs_chuckey_perc <- significance(Loc3$Percent, chuckey$Percent, Loc3$`Percent Margin of Error`, chuckey$`Percent Margin of Error`, clevel = 0.95)

Loc3_vs_chuckey_counts <- significance(Loc3$Count, chuckey$Count, Loc3$`Margin of Error`, chuckey$`Margin of Error`, clevel = 0.95)

Loc3_vs_chuckey <- data.frame(vector_names, Loc3_vs_chuckey_perc, Loc3_vs_chuckey_counts, Loc3$Percent, chuckey$Percent, Loc3$Count, chuckey$Count)

Loc3_vs_boonescreek <- data.frame(vector_names, Loc3_vs_bc_perc, Loc3_vs_bc_counts, Loc3$Percent, boonescreek$Percent, Loc3$Count, boonescreek$Count)

Loc3_vs_cf_perc <- significance(Loc3$Percent, childrenfirst$Percent, Loc3$`Percent Margin of Error`, childrenfirst$`Percent Margin of Error`, 0.95)

Loc3_vs_cf_counts <- significance(Loc3$Count, childrenfirst$Count, Loc3$`Margin of Error`, childrenfirst$`Margin of Error`, clevel = 0.95)

Loc3_vs_childrenfirst <- data.frame(vector_names, Loc3_vs_cf_perc, Loc3_vs_cf_counts, Loc3$Percent, childrenfirst$Percent, Loc3$Count, childrenfirst$Count)

Loc3_vs_lt_perc <- significance(Loc3$Percent, laketerrace$Percent, Loc3$`Percent Margin of Error`, laketerrace$`Percent Margin of Error`, 0.95)

Loc3_vs_lt_counts <- significance(Loc3$Count, laketerrace$Count, Loc3$`Margin of Error`, laketerrace$`Margin of Error`, clevel = 0.95)

Loc3_vs_laketerrace <- data.frame(vector_names, Loc3_vs_lt_perc, Loc3_vs_lt_counts, Loc3$Percent, laketerrace$Percent, Loc3$Count, laketerrace$Count)

#dunbar

Loc3_vs_db_perc <- significance(Loc3$Percent, dunbar$Percent, Loc3$`Percent Margin of Error`, dunbar$`Percent Margin of Error`, 0.95)

Loc3_vs_db_counts <- significance(Loc3$Count, dunbar$Count, Loc3$`Margin of Error`, dunbar$`Margin of Error`, clevel = 0.95)

Loc3_vs_dunbar <- data.frame(vector_names, Loc3_vs_db_perc, Loc3_vs_db_counts, Loc3$Percent, dunbar$Percent, Loc3$Count, dunbar$Count)

#harmony

Loc3_vs_hm_perc <- significance(Loc3$Percent, Harmony$Percent, Loc3$`Percent Margin of Error`, Harmony$`Percent Margin of Error`, 0.95)

Loc3_vs_hm_counts <- significance(Loc3$Count, Harmony$Count, Loc3$`Margin of Error`, Harmony$`Margin of Error`, clevel = 0.95)

Loc3_vs_harmony <- data.frame(vector_names, Loc3_vs_hm_perc, Loc3_vs_hm_counts, Loc3$Percent, Harmony$Percent, Loc3$Count, Harmony$Count)


#grandview

Loc3_vs_gv_perc <- significance(Loc3$Percent, Grandview$Percent, Loc3$`Percent Margin of Error`, Grandview$`Percent Margin of Error`, 0.95)

Loc3_vs_gv_counts <- significance(Loc3$Count, Grandview$Count, Loc3$`Margin of Error`, Grandview$`Margin of Error`, clevel = 0.95)

Loc3_vs_grandview <- data.frame(vector_names, Loc3_vs_gv_perc, Loc3_vs_gv_counts, Loc3$Percent, Grandview$Percent, Loc3$Count, Grandview$Count)

#southside

Loc3_vs_ss_perc <- significance(Loc3$Percent, southside$Percent, Loc3$`Percent Margin of Error`, southside$`Percent Margin of Error`, 0.95)

Loc3_vs_ss_counts <- significance(Loc3$Count, southside$Count, Loc3$`Margin of Error`, southside$`Margin of Error`, clevel = 0.95)

Loc3_vs_southside <- data.frame(vector_names, Loc3_vs_ss_perc, Loc3_vs_ss_counts, Loc3$Percent, southside$Percent, Loc3$Count, southside$Count)

l3bc <- datatable(Loc3_vs_boonescreek)
l3ch <- datatable(Loc3_vs_chuckey)
l3cf <- datatable(Loc3_vs_childrenfirst)
l3lt <- datatable(Loc3_vs_laketerrace)
l3db <- datatable(Loc3_vs_dunbar)
l3hm <- datatable(Loc3_vs_harmony)
l3gv <- datatable(Loc3_vs_grandview)
l3ss <- datatable(Loc3_vs_southside)

#loc2


Loc2_vs_bc_perc <- significance(Loc2$Percent, boonescreek$Percent, Loc2$`Percent Margin of Error`, boonescreek$`Percent Margin of Error`, 0.95)

Loc2_vs_bc_counts <- significance(Loc2$Count, boonescreek$Count, Loc2$`Margin of Error`, boonescreek$`Margin of Error`, clevel = 0.95)

Loc2_vs_chuckey_perc <- significance(Loc2$Percent, chuckey$Percent, Loc2$`Percent Margin of Error`, chuckey$`Percent Margin of Error`, clevel = 0.95)

Loc2_vs_chuckey_counts <- significance(Loc2$Count, chuckey$Count, Loc2$`Margin of Error`, chuckey$`Margin of Error`, clevel = 0.95)

Loc2_vs_chuckey <- data.frame(vector_names, Loc2_vs_chuckey_perc, Loc2_vs_chuckey_counts, Loc2$Percent, chuckey$Percent, Loc2$Count, chuckey$Count)

Loc2_vs_boonescreek <- data.frame(vector_names, Loc2_vs_bc_perc, Loc2_vs_bc_counts, Loc2$Percent, boonescreek$Percent, Loc2$Count, boonescreek$Count)

Loc2_vs_cf_perc <- significance(Loc2$Percent, childrenfirst$Percent, Loc2$`Percent Margin of Error`, childrenfirst$`Percent Margin of Error`, 0.95)

Loc2_vs_cf_counts <- significance(Loc2$Count, childrenfirst$Count, Loc2$`Margin of Error`, childrenfirst$`Margin of Error`, clevel = 0.95)

Loc2_vs_childrenfirst <- data.frame(vector_names, Loc2_vs_cf_perc, Loc2_vs_cf_counts, Loc2$Percent, childrenfirst$Percent, Loc2$Count, childrenfirst$Count)

Loc2_vs_lt_perc <- significance(Loc2$Percent, laketerrace$Percent, Loc2$`Percent Margin of Error`, laketerrace$`Percent Margin of Error`, 0.95)

Loc2_vs_lt_counts <- significance(Loc2$Count, laketerrace$Count, Loc2$`Margin of Error`, laketerrace$`Margin of Error`, clevel = 0.95)

Loc2_vs_laketerrace <- data.frame(vector_names, Loc2_vs_lt_perc, Loc2_vs_lt_counts, Loc2$Percent, laketerrace$Percent, Loc2$Count, laketerrace$Count)

#dunbar

Loc2_vs_db_perc <- significance(Loc2$Percent, dunbar$Percent, Loc2$`Percent Margin of Error`, dunbar$`Percent Margin of Error`, 0.95)

Loc2_vs_db_counts <- significance(Loc2$Count, dunbar$Count, Loc2$`Margin of Error`, dunbar$`Margin of Error`, clevel = 0.95)

Loc2_vs_dunbar <- data.frame(vector_names, Loc2_vs_db_perc, Loc2_vs_db_counts, Loc2$Percent, dunbar$Percent, Loc2$Count, dunbar$Count)

#harmony

Loc2_vs_hm_perc <- significance(Loc2$Percent, Harmony$Percent, Loc2$`Percent Margin of Error`, Harmony$`Percent Margin of Error`, 0.95)

Loc2_vs_hm_counts <- significance(Loc2$Count, Harmony$Count, Loc2$`Margin of Error`, Harmony$`Margin of Error`, clevel = 0.95)

Loc2_vs_harmony <- data.frame(vector_names, Loc2_vs_hm_perc, Loc2_vs_hm_counts, Loc2$Percent, Harmony$Percent, Loc2$Count, Harmony$Count)


#grandview

Loc2_vs_gv_perc <- significance(Loc2$Percent, Grandview$Percent, Loc2$`Percent Margin of Error`, Grandview$`Percent Margin of Error`, 0.95)

Loc2_vs_gv_counts <- significance(Loc2$Count, Grandview$Count, Loc2$`Margin of Error`, Grandview$`Margin of Error`, clevel = 0.95)

Loc2_vs_grandview <- data.frame(vector_names, Loc2_vs_gv_perc, Loc2_vs_gv_counts, Loc2$Percent, Grandview$Percent, Loc2$Count, Grandview$Count)

#southside

Loc2_vs_ss_perc <- significance(Loc2$Percent, southside$Percent, Loc2$`Percent Margin of Error`, southside$`Percent Margin of Error`, 0.95)

Loc2_vs_ss_counts <- significance(Loc2$Count, southside$Count, Loc2$`Margin of Error`, southside$`Margin of Error`, clevel = 0.95)

Loc2_vs_southside <- data.frame(vector_names, Loc2_vs_ss_perc, Loc2_vs_ss_counts, Loc2$Percent, southside$Percent, Loc2$Count, southside$Count)

l2bc <- datatable(Loc2_vs_boonescreek)
l2ch <- datatable(Loc2_vs_chuckey)
l2cf <- datatable(Loc2_vs_childrenfirst)
l2lt <- datatable(Loc2_vs_laketerrace)
l2db <- datatable(Loc2_vs_dunbar)
l2hm <- datatable(Loc2_vs_harmony)
l2gv <- datatable(Loc2_vs_grandview)
l2ss <- datatable(Loc2_vs_southside)

#loc 15


Loc15_vs_bc_perc <- significance(Loc15$Percent, boonescreek$Percent, Loc15$`Percent Margin of Error`, boonescreek$`Percent Margin of Error`, 0.95)

Loc15_vs_bc_counts <- significance(Loc15$Count, boonescreek$Count, Loc15$`Margin of Error`, boonescreek$`Margin of Error`, clevel = 0.95)

Loc15_vs_chuckey_perc <- significance(Loc15$Percent, chuckey$Percent, Loc15$`Percent Margin of Error`, chuckey$`Percent Margin of Error`, clevel = 0.95)

Loc15_vs_chuckey_counts <- significance(Loc15$Count, chuckey$Count, Loc15$`Margin of Error`, chuckey$`Margin of Error`, clevel = 0.95)

Loc15_vs_chuckey <- data.frame(vector_names, Loc15_vs_chuckey_perc, Loc15_vs_chuckey_counts, Loc15$Percent, chuckey$Percent, Loc15$Count, chuckey$Count)

Loc15_vs_boonescreek <- data.frame(vector_names, Loc15_vs_bc_perc, Loc15_vs_bc_counts, Loc15$Percent, boonescreek$Percent, Loc15$Count, boonescreek$Count)

Loc15_vs_cf_perc <- significance(Loc15$Percent, childrenfirst$Percent, Loc15$`Percent Margin of Error`, childrenfirst$`Percent Margin of Error`, 0.95)

Loc15_vs_cf_counts <- significance(Loc15$Count, childrenfirst$Count, Loc15$`Margin of Error`, childrenfirst$`Margin of Error`, clevel = 0.95)

Loc15_vs_childrenfirst <- data.frame(vector_names, Loc15_vs_cf_perc, Loc15_vs_cf_counts, Loc15$Percent, childrenfirst$Percent, Loc15$Count, childrenfirst$Count)

Loc15_vs_lt_perc <- significance(Loc15$Percent, laketerrace$Percent, Loc15$`Percent Margin of Error`, laketerrace$`Percent Margin of Error`, 0.95)

Loc15_vs_lt_counts <- significance(Loc15$Count, laketerrace$Count, Loc15$`Margin of Error`, laketerrace$`Margin of Error`, clevel = 0.95)

Loc15_vs_laketerrace <- data.frame(vector_names, Loc15_vs_lt_perc, Loc15_vs_lt_counts, Loc15$Percent, laketerrace$Percent, Loc15$Count, laketerrace$Count)

#dunbar

Loc15_vs_db_perc <- significance(Loc15$Percent, dunbar$Percent, Loc15$`Percent Margin of Error`, dunbar$`Percent Margin of Error`, 0.95)

Loc15_vs_db_counts <- significance(Loc15$Count, dunbar$Count, Loc15$`Margin of Error`, dunbar$`Margin of Error`, clevel = 0.95)

Loc15_vs_dunbar <- data.frame(vector_names, Loc15_vs_db_perc, Loc15_vs_db_counts, Loc15$Percent, dunbar$Percent, Loc15$Count, dunbar$Count)

#harmony

Loc15_vs_hm_perc <- significance(Loc15$Percent, Harmony$Percent, Loc15$`Percent Margin of Error`, Harmony$`Percent Margin of Error`, 0.95)

Loc15_vs_hm_counts <- significance(Loc15$Count, Harmony$Count, Loc15$`Margin of Error`, Harmony$`Margin of Error`, clevel = 0.95)

Loc15_vs_harmony <- data.frame(vector_names, Loc15_vs_hm_perc, Loc15_vs_hm_counts, Loc15$Percent, Harmony$Percent, Loc15$Count, Harmony$Count)


#grandview

Loc15_vs_gv_perc <- significance(Loc15$Percent, Grandview$Percent, Loc15$`Percent Margin of Error`, Grandview$`Percent Margin of Error`, 0.95)

Loc15_vs_gv_counts <- significance(Loc15$Count, Grandview$Count, Loc15$`Margin of Error`, Grandview$`Margin of Error`, clevel = 0.95)

Loc15_vs_grandview <- data.frame(vector_names, Loc15_vs_gv_perc, Loc15_vs_gv_counts, Loc15$Percent, Grandview$Percent, Loc15$Count, Grandview$Count)

#southside

Loc15_vs_ss_perc <- significance(Loc15$Percent, southside$Percent, Loc15$`Percent Margin of Error`, southside$`Percent Margin of Error`, 0.95)

Loc15_vs_ss_counts <- significance(Loc15$Count, southside$Count, Loc15$`Margin of Error`, southside$`Margin of Error`, clevel = 0.95)

Loc15_vs_southside <- data.frame(vector_names, Loc15_vs_ss_perc, Loc15_vs_ss_counts, Loc15$Percent, southside$Percent, Loc15$Count, southside$Count)

l15bc <- datatable(Loc15_vs_boonescreek)
l15ch <- datatable(Loc15_vs_chuckey)
l15cf <- datatable(Loc15_vs_childrenfirst)
l15lt <- datatable(Loc15_vs_laketerrace)
l15db <- datatable(Loc15_vs_dunbar)
l15hm <- datatable(Loc15_vs_harmony)
l15gv <- datatable(Loc15_vs_grandview)
l15ss <- datatable(Loc15_vs_southside)


```

